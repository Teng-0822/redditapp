<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BEAST MODE</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<style>
  :root {
    --bg: #0d0d0d;
    --card: #1a1a1a;
    --accent: #ff0066;
    --accent2: #00ff99;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    background: var(--bg);
    color: white;
    font-family: 'Segoe UI', Arial, sans-serif;
    min-height: 100vh;
    padding: 15px 15px 110px 15px;
    background: linear-gradient(135deg, #0d0d0d 0%, #1a0033 100%);
  }
  h1 {
    text-align:center;
    font-size: 2.8rem;
    background: linear-gradient(90deg, #ff0066, #00ff99);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin: 15px 0 20px;
  }
  #ipInput {
    display: block;
    width: 110px;
    margin: 0 auto 15px;
    padding: 8px;
    font-size: 1rem;
    text-align: center;
    background: #222;
    color: #0f9;
    border: 1px solid #444;
    border-radius: 10px;
  }

  /* DROPDOWNS */
  .dropdown {
    background: var(--card);
    border-radius: 18px;
    margin: 16px auto;
    max-width: 420px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.8);
    border: 1px solid #333;
    overflow: hidden;
  }
  .dropdown-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 24px;
    cursor: pointer;
    background: rgba(255,255,255,0.03);
  }
  .center-btn {
    flex: 1;
    display: flex;
    justify-content: center;
  }
  .dropdown-header button {
    padding: 11px 40px;
    font-size: 1.25rem;
    font-weight: bold;
    border: none;
    border-radius: 16px;
    min-width: 180px;
    height: 52px;
  }
  #subrBtn    { background: linear-gradient(45deg, #ff0066, #ff3366); }
  #captionBtn { background: linear-gradient(45deg, #9b59b6, #e91e63); }

  .ip-header {
    font-size: 1.4rem;
    font-weight: bold;
    color: #0f9;
    flex: 1;
    text-align: left;
    padding-left: 8px;
  }

  .arrow {
    font-size: 28px;
    transition: transform 0.3s ease;
    color: #aaa;
    min-width: 50px;
    text-align: right;
  }
  .arrow.open { transform: rotate(180deg); }

  .dropdown-content {
    padding: 0 20px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease, padding 0.4s ease;
    background: rgba(0,0,0,0.3);
  }
  .dropdown-content.open {
    max-height: 600px;
    padding: 16px 20px;
  }
  .content-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 12px 0;
    font-size: 0.95rem;
    color: #ccc;
  }
  .content-row button {
    background: #333;
    color: #ff0066;
    border: 2px solid #ff0066;
    padding: 8px 16px;
    border-radius: 12px;
    font-size: 0.9rem;
  }
  .content-row .toggle {
    background: #222;
    color: #999;
    border: 1px solid #444;
  }

  ul {
    list-style: none;
    max-height: 260px;
    overflow-y: auto;
    padding: 8px;
    background: #111;
    border-radius: 10px;
    border: 1px solid #333;
    margin-top: 12px;
    -webkit-overflow-scrolling: touch;
  }
  li {
    padding: 12px;
    background: #222;
    margin: 8px 0;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 12px;
    position: relative;
    overflow: hidden;
  }
  li.checked { opacity: 0.4; text-decoration: line-through; }
  li .text {
    flex: 1;
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 0.95rem;
    color: #ddd;
    padding-right: 10px;
  }
  li .text::after {
    content: '';
    position: absolute;
    right: 60px; top: 0; bottom: 0;
    width: 30px;
    background: linear-gradient(to right, transparent, #222);
    pointer-events: none;
  }
  .delete {
    background: none;
    border: none;
    color: var(--accent);
    font-size: 28px;
    font-weight: bold;
    min-width: 44px;
    text-align: center;
    cursor: pointer;
  }

  #rotateBtn {
    padding: 8px 12px;
    border-radius: 10px;
    background: #ff0066;
    color: white;
    border: none;
  }
  #refreshBtn {
    padding: 10px 16px;
    background: #111;
    color: #0f9;
    border: 1px solid #0f9;
    border-radius: 10px;
    font-size: 11px;
  }

  .fab-container {
    position: fixed;
    bottom: 18px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 18px;
    z-index: 9999;
    background: rgba(20,20,20,0.8);
    padding: 12px 24px;
    border-radius: 50px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.1);
    box-shadow: 0 8px 30px rgba(0,0,0,0.6);
  }
  .fab {
    width: 64px; height: 64px;
    border-radius: 50%;
    border: none;
    color: white;
    font-size: 26px;
    font-weight: bold;
    box-shadow: 0 6px 20px rgba(0,0,0,0.8);
  }
  .fab:active { transform: scale(0.9); }

  #toast {
    position: fixed;
    bottom: 110px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.9);
    color: #0f9;
    padding: 12px 28px;
    border-radius: 30px;
    font-weight: bold;
    font-size: 1rem;
    z-index: 10000;
    opacity: 0;
    transition: all 0.4s;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(0,255,153,0.3);
    pointer-events: none;
  }
  #toast.show { opacity: 1; bottom: 130px; }

  /* BEAUTIFUL FLOATING COMBO BUTTON ‚Äì TOP RIGHT */
#comboFab {
  position: fixed;
  top: 550px;
  right: 18px;
  width: 68px;
  height: 68px;
  background: linear-gradient(135deg, #ff0066, #ff3366, #00ff99);
  color: white;
  border: none;
  border-radius: 50%;
  font-size: 18px;
  font-weight: 900;
  letter-spacing: 1px;
  box-shadow: 
    0 8px 25px rgba(255,0,102,0.6),
    0 0 30px rgba(0,255,153,0.4),
    inset 0 0 20px rgba(255,255,255,0.2);
  z-index: 99999;
  cursor: pointer;
  animation: pulseGlow 3s infinite alternate;
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255,255,255,0.2);
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  text-shadow: 0 0 10px #000;
}

#comboFab:hover {
  transform: scale(1.1) rotate(5deg);
  box-shadow: 0 0 40px rgba(255,0,102,0.8), 0 0 60px rgba(0,255,153,0.6);
}

#comboFab:active {
  transform: scale(0.95);
}

@keyframes pulseGlow {
  from { box-shadow: 0 8px 25px rgba(255,0,102,0.6), 0 0 30px rgba(0,255,153,0.4); }
  to   { box-shadow: 0 12px 40px rgba(255,0,102,0.9), 0 0 50px rgba(0,255,153,0.7); }
}
</style>
</head>
<body>
<div style="display:flex; align-items:center; justify-content:center; gap:14px; margin:20px auto 15px; max-width:420px; padding:0 10px;">
  
  <!-- IP Input -->
  <input type="text" id="ipInput" placeholder="IP last" value="1" maxlength="3"
         style="width:96px; height:48px; padding:8px; font-size:1.1rem; text-align:center; 
                background:#222; color:#0f9; border:2px solid #0f9; border-radius:14px; 
                font-weight:bold; outline:none;">

  <!-- Toggle Button -->
  <button id="ipToggle" 
          style="height:48px; padding:0 20px; background:#333; color:#0f9; 
                 border:2px solid #0f9; border-radius:14px; font-weight:bold; 
                 font-size:1.05rem; min-width:148px; cursor:pointer; transition:all 0.2s;">
    192.168.1.x
  </button>
</div>

<!-- PROFILE DROPDOWN - CONNECTED TO GOOGLE SHEET -->
<div class="dropdown">
  <div class="dropdown-header">
    <div class="center-btn"><button style="background:linear-gradient(45deg,#8e2de2,#4a00e0);cursor:default;">PROFILE</button></div>
    <span class="arrow" id="profileArrow" onclick="toggleDropdown('profile')">üëáüèº</span>
  </div>
  <div class="dropdown-content" id="profileContent">
    <div style="padding:16px 20px; max-width:100%; box-sizing:border-box;">
      
      <!-- 2√ó2 GRID - Responsive & Safe -->
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px 12px; margin-bottom:12px;">
        <input type="text" id="profileName" placeholder="Name" readonly
               style="padding:13px 10px; border-radius:12px; background:#222; border:2px solid #8e2de2; color:#0f9; text-align:center; font-weight:bold; font-size:0.95rem; width:100%;">
        <input type="text" id="profileUser" placeholder="Username"
               style="padding:13px 10px; border-radius:12px; background:#222; border:2px solid #2196f3; color:white; text-align:center; font-size:0.95rem; width:100%;">
        <input type="text" id="profilePass" placeholder="Password"
               style="padding:13px 10px; border-radius:12px; background:#222; border:2px solid #ff0066; color:white; text-align:center; font-size:0.95rem; width:100%;">
        <input type="text" id="profileID" placeholder="ID" readonly
               style="padding:13px 10px; border-radius:12px; background:#222; border:2px solid #00ff99; color:#0f9; text-align:center; font-weight:bold; font-size:0.95rem; width:100%;">
      </div>

      <!-- COPY BUTTONS - 2√ó2 Responsive -->
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:12px;">
        <button onclick="copyText('profileName')" style="background:#4a00e0; color:white; padding:12px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Copy Name</button>
        <button onclick="copyText('profileUser')" style="background:#2196f3; color:white; padding:12px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Copy User</button>
        <button onclick="copyText('profilePass')" style="background:#ff0066; color:white; padding:12px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Copy Pass</button>
        <button onclick="copyText('profileID')" style="background:#00ff99; color:#000; padding:12px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Copy ID</button>
      </div>

      <!-- FINAL BUTTON LAYOUT: 4 on top, Save centered below -->
      <div style="display:flex; flex-direction:column; gap:11px; align-items:center;">
        <!-- Top row: Prev | Generate | Username | Next -->
        <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:9px; width:100%; max-width:380px;">
          <button onclick="prevProfile()" style="background:#333; color:#ff0066; padding:13px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Prev</button>
          <button onclick="generatePassword()" style="background:#00ff99; color:#000; padding:13px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Generate</button>
          <button onclick="pasteUsername()" style="background:#2196f3; color:white; padding:13px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Username</button>
          <button onclick="nextProfile()" style="background:#333; color:#00ff99; padding:13px 8px; border-radius:12px; font-weight:bold; font-size:0.9rem;">Next</button>
        </div>

        <!-- Bottom row: Save button centered and wider -->
        <button onclick="saveProfile()" 
                style="background:#ff0066; color:white; padding:14px 20px; border-radius:14px; font-weight:bold; font-size:1rem; 
                       min-width:180px; width:auto; max-width:340px;">
          Save
        </button>
      </div>

    </div>
  </div>
</div>


<!-- SUBREDDIT DROPDOWN -->
<div class="dropdown">
  <div class="dropdown-header">
    <div class="center-btn"><button id="subrBtn" onclick="event.stopPropagation()">SUBR</button></div>
    <span class="arrow" id="subArrow" onclick="toggleDropdown('sub')">üëáüèº</span>
  </div>
  <div class="dropdown-content" id="subContent">
    <div class="content-row">
      <span>Done <span id="subDone">0</span> / <span id="subCount">0</span></span>
      <div style="display:flex; gap:8px;">
        <button id="subrReset">Reset</button>
        <button id="addSubBtn" style="background:#00ff99;color:#000;padding:8px 16px;border-radius:12px;font-weight:bold;">+ Add</button>
      </div>
    </div>
    <div class="content-row"><span></span><button class="toggle" id="toggleSub">List</button></div>
    <ul id="subList" style="display:none;"></ul>
  </div>
</div>

<!-- CAPTION DROPDOWN -->
<div class="dropdown">
  <div class="dropdown-header">
    <div class="center-btn"><button id="captionBtn" onclick="event.stopPropagation()">CAPTION</button></div>
    <span class="arrow" id="capArrow" onclick="toggleDropdown('cap')">üëáüèº</span>
  </div>
  <div class="dropdown-content" id="capContent">
    <div class="content-row">
      <span>Used <span id="capUsed">0</span> / <span id="capCount">0</span></span>
      <div style="display:flex; gap:8px;">
        <button id="captionReset">Reset</button>
        <button id="addCapBtn" style="background:#00ff99;color:#000;padding:8px 16px;border-radius:12px;font-weight:bold;">+ Add</button>
      </div>
    </div>
    
    <div class="content-row" style="justify-content: flex-end; gap: 10px;">
      <button onclick="updateCaptionsNow()" 
              style="background:#333; color:#00ff99; border:2px solid #00ff99; padding:8px 14px; border-radius:12px; font-weight:bold; font-size:1rem;">
        Refresh
      </button>
      <button class="toggle" id="toggleCap" 
              style="padding:8px 16px; border-radius:12px;">
        List
      </button>
    </div>

    <ul id="captionList" style="display:none;"></ul>
  </div>
</div>

<!-- IP & ROTATION DROPDOWN -->
<div class="dropdown">
  <div class="dropdown-header">
    <div class="ip-header"><span id="ipHeader">Loading IP...</span></div>
    <span class="arrow" id="ipArrow" onclick="toggleDropdown('ip')">üëáüèº</span>
  </div>
  <div class="dropdown-content" id="ipContent">
    <div style="padding:10px 0;">
      <div style="display:flex; gap:5px; margin:10px 0;">
        <button id="rotateBtn" onclick="rotateIP()">Go</button>
        <input id="rotateLink" placeholder="http://87.120..." style="flex:1;padding:8px;border-radius:10px;background:#222;border:1px solid #444;color:white;" />
      </div>
      <div style="background:rgba(10,10,30,0.95);border-radius:12px;padding:14px;text-align:center;font-family:monospace;border:1px solid #333;">
        <div style="color:#0af;font-size:10px;">Old to <span id="oldIP">‚Äî</span></div>
        <div id="ip" style="color:#0f9;font-size:17px;font-weight:bold;margin:10px 0;">Loading...</div>
        <button id="refreshBtn" onclick="refreshAndOpen()">Refresh + Scam</button>
      </div>
    </div>
  </div>
</div>

<!-- NEW SUPER BUTTON ‚Äì TOP FLOATING -->
<button id="comboFab">SUB + CAP</button>

  
<div class="fab-container">
  <button id="fabD"    class="fab" style="background:linear-gradient(45deg,#e91e63,#ff0066)">D</button>
  <button id="fabN"    class="fab" style="background:linear-gradient(45deg,#00ff99,#00cc77)">N</button>
  <button id="fabOF"   class="fab" style="background:linear-gradient(45deg,#2196f3,#00bcd4)">OF</button>
  <button id="fabLink" class="fab" style="background:linear-gradient(45deg,#9c27b0,#e040fb)">Link</button>
  <button id="fabCreate" class="fab" style="background:linear-gradient(45deg,#ff0066,#ff3366)">+</button>
</div>

<div id="toast"></div>

<script>
// ‚Üê All the powerful code from the previous version is still here (unchanged)
// Only the UI labels above the buttons have been removed as requested.
// Everything works exactly the same: auto-reset, no repeats, copy + open, etc.
const defaultSubs = [
"2007hotgirls","420_710_OnlyFans","530onlyfanslinks","559_keep_on_the_DL","AdorableBoobs","AhegaoHardcore",
"alabamafuckbuddy","AmateurContent","AmatuersofOnlyFans","Asian_Angels","AssClappersINC","assgirls",
"Babes_No_Face","BabesOnOnlyfans","BaddieWithAFatty","balkan_onlyfans","BBCFEMBOYS","BdsmNoRestriction",
"BDSMOnlyFans_Pages","BDSMOnlyFansPromos","beggingtobeused","BellyButtonWorld","Best_LingerieOnlyFans",
"BestChest","BigTitsBigAreolas","BigtitsOfTiktok","boobtease","BornToBeBreed","Breedinghotwives",
"BUSTYQUEENS","buttsgonewild","Casalonlyfans","cellulite_gw","cheatingamateur","CheatingPOV",
"Chicasenlenceria","ChurchMILF","contenidorealchicas","ContentClubhouse","cuckoldcheating",
"CuteFuckToys","cutiesandbooties","daddysfucktoyz","DailySluts","degradedslutr4r","Desperatewhoress",
"DildoXXX","DL_Hood_Ninja","dressedhot","EbonyOnlyfansPromo","EuropeanOnlyFans","fanslybuyers",
"FanslyOnlyFans","feedees4feeders","FeetAdmirers","feetfindercom","feetpicsbuyerandsell","FemaleFeet",
"findominatrix","footaddictz","FootSlaveMarket","freegirlsOnlyfans","fuckingtweakersthe2nd",
"fuckmywifewitme","bbwwifesharing","CollegeGirlNextDoor","Marriedandflirting","hotdommes",
"TradeNudessssssssss","ratemynudeselfie1","Moms_Gone_Wild","SchoolgirlsXXX","shareingsexywife",
"amateurslutsgonewild","SSBBW_FANS","HoesOnTheGo","BoobsNation","CulosDeMexicanas","soleslovers",
"sharing_IS_CaringNSFW","OnlyNaturalBoobs","fansdewaifu","OnlyMomTits","RateMyTitsOutOfTen",
"GoonForAss","SpicySlut","Rate_My_Wife_","AverageWife","CapeTownSwingers","highsocietyswingerph",
"SouthCarolinaFreaky","IndianInstaBaddies","PolskaBezCenzuryNSFW","Mumbaihookupsonly",
"FwbmeetupIndiana","AdultNursingFemales4M","NackteTatsachen","HentaiTruthOrDare","eatingowncum",
"SpunAkron","seattle_cuckold","NashvilleSpunonymous","StraightFemboyDating","SnapGroup18PlusGirls",
"Gaytreff_Hessen","Brisbanenaughty","Tgroups","LucknowGay","sexigatjejersverige","FTMsSeekingcock",
"OregonStateUnivHookup","denversmallcocks","TurkGayPaylasim","Berlin_Gays","midlandtxswingersfwb"
];

  const defaultCaptions = [
  "be honest... would you stare if you saw me in public?",
  "your secrets are safe with me... but are mine safe with you?",
  "i might delete this later, so look while you can",
  "i wonder what you're thinking right now",
  "this bra is getting in the way, don't you think?",
  "yes i'm 18, no you can't handle me",
  "i bite... but only if you ask nicely",
  "wanna see the back view too?",
  "tell me your fantasy and i'll tell you if i'd let you do it",
  "i'm sweeter than i look, taste test?",
  "you're scrolling... but you stopped here for a reason",
  "don't just like this, tell me what you'd do to me",
  "i'm bad at hiding when i'm turned on",
  "say \"yes\" if you'd risk it all for one night",
  "this body was made for sinning",
  "i look innocent until i'm not",
  "your girlfriend thinks i'm cute too",
  "wanna be the reason i can't walk tomorrow?",
  "i'm shy until my clothes come off",
  "bet you can't make me blush... try me",
  "i'm 5'2 but my attitude is 6'5 in bed",
  "tell me where you'd put your hands first",
  "i don't usually do this... but for you i might",
  "your move, daddy",
  "i'm bored... entertain me or undress me",
  "i promise i'm tighter than your ex",
  "can you tell i'm not wearing anything underneath?",
  "i need a volunteer to come ruin my lipstick",
  "this mirror has seen things",
  "say \"hi\" if you're thinking dirty thoughts right now",
  "i'm a good girl... with very bad habits",
  "wanna see how flexible your new toy is?",
  "i don't need a filter when i have this body",
  "i look cute but i ride better than your ex",
  "yes they're real, no you can't touch... yet",
  "tell me i'm pretty while i sit on your face",
  "i'm the reason your phone battery dies at night",
  "i like my men how i like my coffee... strong and hot",
  "you + me + no clothes = ?",
  "i'm trouble but the fun kind",
  "wanna be my late-night distraction?",
  "i'm addicted to the attention you give me",
  "can keep a secret if you can keep your hands to yourself",
  "this ass deserves its own fan club",
  "i'm soft in all the right places",
  "your parents would hate me... your bed wouldn't",
  "i don't chase, i attract",
  "i'm the view you'll never get tired of",
  "tell me your kink and i'll tell you if i'm into it",
  "i'm legal and lethal",
  "i look better with your handprints on me",
  "i'm the girl your mom warned you about",
  "wanna see what this mouth do?",
  "i'm sweet until i'm on top",
  "i don't do nudes... i do art",
  "bet you'd last 30 seconds with me",
  "i'm the fantasy you can't tell anyone about",
  "i'm small but i can take it all",
  "tell me \"good girl\" and watch what happens",
  "i'm only bad if you make me",
  "your wishlist just got one item longer",
  "i'm the reason you have trust issues",
  "i'm cute until the lights go off",
  "wanna be the hand around my throat?",
  "i'm the girl you'll never get over",
  "i look innocent but my thoughts are filthy",
  "this body counts as a weapon in 47 states",
  "i'm the best you'll never have",
  "i'm sweet like candy, bad like whiskey",
  "tell me no and watch me do it anyway",
  "i'm the update your ex is afraid of",
  "i'm tiny but my sex drive isn't",
  "i'm the risk you'll never regret taking",
  "i'm the reason your phone is on 1%",
  "i'm not for everyone... just the brave ones",
  "i'm the girl your friends warned you about",
  "i'm soft, warm, and currently not wearing panties",
  "i'm the plot twist you didn't see coming",
  "i'm the sin you'll confess on sunday",
  "i'm the notification you always open first",
  "i'm the \"one more pic\" you can't resist",
  "i'm the reason you believe in love at first sight again",
  "i'm the addiction you'll never recover from",
  "i'm the secret you'll take to your grave",
  "i'm the fantasy that keeps you up at night",
  "i'm the girl you'll compare everyone else to",
  "i'm the trouble you've been praying for"
];
  
const dmTexts = [
"I‚Äôm new here, come take a peek at my page below and enjoy a little surprise I left for you",
"Still figuring things out here, check out my page and grab your free surprise",
"Just getting started here, have a look at my page and claim your cute freebie",
"I‚Äôm the new girl here, check my page and treat yourself to a sweet surprise",
"Super new here, come visit my page and enjoy a little gift from me",
"Just joined, have a look at my page and don‚Äôt miss the free surprise waiting for you",
"Newbie alert, come check my page and grab the adorable surprise I made for you",
"I‚Äôm fresh here, take a moment to visit my page and get your special little treat",
"Still new around here, check out my page and enjoy your free surprise",
"Just starting out here, come see my page and pick up the cute surprise I prepared for you"
];

const names = [
"Sophyy üå∏",
"Sophiaa üå∑",
"Sophi üíã",
"Sophiya üå∫",
"Sofayuh üòç",
"Soffie üåº",
"Sofey üíñ",
"Soffyy üòù",
"Sofy üíò",
"Sofiy ü¶ã",
"Sofiahh üç¨",
"Sofiaaaa üíï",
"Sophie üòù",
"Sophia üòä",
"Sofie üôà",
"Sofiaa üòç",
"Sofia üçë",
"Sofiyah ‚ú®",
"Sofiya üíû",
"Sofii üíï",
"Sofiee üòò",
"Sofiah üíó",
"Sophiyaaa üòç",
"Sophiie üôà",
"Sofiyaaa ‚ú®"
];

const ofLines = [
"OF (nudes&dms)üòú",
"OF (nudez&seks)üòú",
"OF (nudes&dms)üôà"
];

const linkUrl = "https://tapformysocials.me/girlygirl";
let subs = JSON.parse(localStorage.getItem('subs3')||'null') || defaultSubs.slice();
let subChecked = JSON.parse(localStorage.getItem('subCh3')||'null') || {};
let subIndex = parseInt(localStorage.getItem('subIdx3')||'0');
let captions = JSON.parse(localStorage.getItem('caps3')||'null') || defaultCaptions.slice();
let capUsed = JSON.parse(localStorage.getItem('capUs3')||'null') || {};
let dmUsed = JSON.parse(localStorage.getItem('dmUsed')||'null') || {};
let nameUsed = JSON.parse(localStorage.getItem('nameUsed')||'null') || {};
let ofUsed = JSON.parse(localStorage.getItem('ofUsed')||'null') || {};

function updateCaptionsNow() {
  localStorage.removeItem('caps3');
  localStorage.removeItem('capUs3');
  location.reload();
}

const save = () => {
  localStorage.setItem('subs3', JSON.stringify(subs));
  localStorage.setItem('subCh3', JSON.stringify(subChecked));
  localStorage.setItem('subIdx3', subIndex);
  localStorage.setItem('caps3', JSON.stringify(captions));
  localStorage.setItem('capUs3', JSON.stringify(capUsed));
  localStorage.setItem('dmUsed', JSON.stringify(dmUsed));
  localStorage.setItem('nameUsed', JSON.stringify(nameUsed));
  localStorage.setItem('ofUsed', JSON.stringify(ofUsed));
};

// Add this anywhere in your <script> (preferably near the top with other globals)
let baseIP = localStorage.getItem('selectedBaseIP') || '192.168.1';

function updateToggleButton() {
  const btn = document.getElementById('ipToggle');
  if (baseIP === '192.168.1') {
    btn.textContent = '192.168.1.x';
    btn.style.background = '#333';
  } else {
    btn.textContent = '10.161.37.x';
    btn.style.background = '#0a3d2e';
  }
}
document.getElementById('ipToggle').onclick = () => {
  baseIP = baseIP === '192.168.1' ? '10.161.37' : '192.168.1';
  localStorage.setItem('selectedBaseIP', baseIP);
  updateToggleButton();
  showToast(`Switched to ${baseIP}.x`);
};

// Update triggerLua to use the selected base
function triggerLua() {
  const ipPart = document.getElementById("ipInput").value.trim();
  if (!ipPart || isNaN(ipPart)) return;
  const url = `http://${baseIP}.${ipPart}:8080/control/start_playing?path=/test.lua&t=${Date.now()}`;
  new Image().src = url;
}

// On page load
window.addEventListener('load', () => {
  updateToggleButton();
  // ... rest of your existing load code ...
});

function toggleDropdown(type) {
  const map = { sub: 'subContent', cap: 'capContent', ip: 'ipContent', profile: 'profileContent' };
  const arrowMap = { sub: 'subArrow', cap: 'capArrow', ip: 'ipArrow', profile: 'profileArrow' };
  const content = document.getElementById(map[type]);
  const arrow = document.getElementById(arrowMap[type]);
  content.classList.toggle('open');
  arrow.classList.toggle('open');
}

const render = (id, data, used) => {
  const ul = document.getElementById(id);
  ul.innerHTML = '';
  data.forEach((item, i) => {
    const li = document.createElement('li');
    li.className = used[item] ? 'checked' : '';
    li.innerHTML = `<input type="checkbox" ${used[item]?'checked':''}>
                    <div class="text">${item}</div>
                    <button class="delete">X</button>`;
    li.querySelector('input').onchange = () => { used[item] = !used[item]; save(); render(id,data,used); updateStats(); };
    li.querySelector('.delete').onclick = () => { if(confirm('Delete?')){ data.splice(i,1); delete used[item]; save(); render(id,data,used); updateStats(); }};
    ul.appendChild(li);
  });
};

const updateStats = () => {
  document.getElementById('subCount').textContent = subs.length;
  document.getElementById('subDone').textContent = Object.values(subChecked).filter(v=>v).length;
  document.getElementById('capCount').textContent = captions.length;
  document.getElementById('capUsed').textContent = Object.values(capUsed).filter(v=>v).length;
  updateIPHeader();
};

render('subList', subs, subChecked);
render('captionList', captions, capUsed);
updateStats();

document.getElementById('subrBtn').onclick = () => {
  if(subs.length===0) return alert("Empty!");
  let attempts=0;
  while(attempts++ < subs.length){
    const sub = subs[subIndex];
    if(!subChecked[sub]){
      navigator.clipboard.writeText(sub);
      window.open(`https://www.reddit.com/r/${sub}/submit`, '_blank');
      subChecked[sub] = true; save(); render('subList',subs,subChecked); updateStats();
      subIndex = (subIndex + 1) % subs.length; save();
      return;
    }
    subIndex = (subIndex + 1) % subs.length;
  }
  subChecked = {}; subIndex = 0; save(); render('subList',subs,subChecked); updateStats();
  alert("All done to auto-reset!");
};

document.getElementById('captionBtn').onclick = () => {
  if(captions.length===0) return alert("Empty!");
  const unused = captions.filter(c => !capUsed[c]);
  if(unused.length===0){ capUsed={}; save(); render('captionList',captions,capUsed); updateStats(); alert("All used to reset!"); }
  const pick = unused.length ? unused[Math.floor(Math.random()*unused.length)] : captions[Math.floor(Math.random()*captions.length)];
  navigator.clipboard.writeText(pick);
  capUsed[pick] = true; save(); render('captionList',captions,capUsed); updateStats();
  triggerLua();
};

function triggerLua() {
  const ipPart = document.getElementById("ipInput").value.trim();
  if (!ipPart || isNaN(ipPart)) return;
  const url = `http://192.168.1.${ipPart}:8080/control/start_playing?path=/test.lua&t=${Date.now()}`;
  new Image().src = url;
}

const randomNoRepeat = (arr, used) => {
  const unused = arr.filter(x => !used[x]);
  if(unused.length===0){ Object.keys(used).forEach(k=>delete used[k]); save(); showToast("Reset!"); return randomNoRepeat(arr, used); }
  const pick = unused[Math.floor(Math.random()*unused.length)];
  navigator.clipboard.writeText(pick); used[pick] = true; save(); triggerLua();
};

document.getElementById('fabD').onclick = () => randomNoRepeat(dmTexts, dmUsed);
document.getElementById('fabN').onclick = () => randomNoRepeat(names, nameUsed);
document.getElementById('fabOF').onclick = () => randomNoRepeat(ofLines, ofUsed);
document.getElementById('fabLink').onclick = () => { navigator.clipboard.writeText(linkUrl); showToast("Link copied"); triggerLua(); };

document.getElementById('subrReset').onclick = () => { if(confirm("Reset subs?")){ subChecked={}; subIndex=0; save(); render('subList',subs,subChecked); updateStats(); }};
document.getElementById('captionReset').onclick = () => { if(confirm("Reset captions?")){ capUsed={}; save(); render('captionList',captions,capUsed); updateStats(); }};

document.getElementById('toggleSub').onclick = () => { const l = document.getElementById('subList'); l.style.display = l.style.display==='block'?'none':'block'; };
document.getElementById('toggleCap').onclick = () => { const l = document.getElementById('captionList'); l.style.display = l.style.display==='block'?'none':'block'; };

//document.getElementById('addSubBtn').onclick = (e) => { e.stopPropagation(); const s=prompt("Subreddit (no r/):"); if(s && s.trim() && !subs.includes(s.trim())){ subs.push(s.trim()); save(); render('subList',subs,subChecked); updateStats(); showToast("Added!"); } else if(s) showToast("Already exists"); };
//document.getElementById('addCapBtn').onclick = (e) => { e.stopPropagation(); const c=prompt("New caption:"); if(c && c.trim() && !captions.includes(c.trim())){ captions.push(c.trim()); save(); render('captionList',captions,capUsed); updateStats(); showToast("Added!"); } else if(c) showToast("Already exists"); };
// ==================== SUBREDDITS ====================
  document.getElementById('addSubBtn').onclick = (e) => {
  e.stopPropagation();
  const input = prompt("Add one or more subreddits (one per line, no r/):");
  if (!input) return;

  const lines = input.split('\n').map(l => l.trim()).filter(l => l);
  let added = 0;
  lines.forEach(sub => {
    if (sub && !subs.includes(sub)) {
      subs.push(sub);
      added++;
    }
  });

  if (added > 0) {
    save();
    render('subList', subs, subChecked);
    updateStats();
    showToast(`Added ${added} subreddit${added > 1 ? 's' : ''}`);
  } else {
    showToast("Nothing new added");
  }
};

// NEW: DELETE ALL SUBREDDITS BUTTON
const subDeleteAllBtn = document.createElement('button');
subDeleteAllBtn.textContent = "Delete All";
subDeleteAllBtn.style.cssText = "background:#c#d32f2f;color:white;padding:8px 14px;border-radius:12px;font-weight:bold;margin-left:8px;";
subDeleteAllBtn.onclick = () => {
  if (confirm("Delete ALL subreddits? This cannot be undone!")) {
    subs = [];
    subChecked = {};
    subIndex = 0;
    save();
    render('subList', subs, subChecked);
    updateStats();
    showToast("All subreddits deleted");
  }
};
document.querySelector('#subContent .content-row:nth-of-type(1) > div').appendChild(subDeleteAllBtn);
  
  // ==================== CAPTIONS ====================
document.getElementById('addCapBtn').onclick = (e) => {
  e.stopPropagation();
  const input = prompt("Add one or more captions (one per line):");
  if (!input) return;

  const lines = input.split('\n').map(l => l.trim()).filter(l => l);
  let added = 0;
  lines.forEach(cap => {
    if (cap && !captions.includes(cap)) {
      captions.push(cap);
      added++;
    }
  });

  if (added > 0) {
    save();
    render('captionList', captions, capUsed);
    updateStats();
    showToast(`Added ${added} caption${added > 1 ? 's' : ''}`);
  } else {
    showToast("Nothing new added");
  }
};

// NEW: DELETE ALL CAPTIONS BUTTON
const capDeleteAllBtn = document.createElement('button');
capDeleteAllBtn.textContent = "Delete All";
capDeleteAllBtn.style.cssText = "background:#d32f2f;color:white;padding:8px 14px;border-radius:12px;font-weight:bold;margin-left:8px;";
capDeleteAllBtn.onclick = () => {
  if (confirm("Delete ALL captions? This cannot be undone!")) {
    captions = [];
    capUsed = {};
    save();
    render('captionList', captions, capUsed);
    updateStats();
    showToast("All captions deleted");
  }
};
document.querySelector('#capContent .content-row:nth-of-type(1) > div').appendChild(capDeleteAllBtn);

  
let userIP = '', previousIP = '', scamalyticsWindow = null;

function updateIPHeader() {
  const ip = document.getElementById('ip').textContent;
  document.getElementById('ipHeader').textContent = (ip && ip !== 'Loading...' && !ip.includes('Failed') && !ip.includes('Offline')) ? ip : 'No IP';
}

fetch('https://api.ipify.org?format=json')
  .then(r => r.json())
  .then(d => { userIP = d.ip; document.getElementById("ip").textContent = userIP; updateIPHeader(); })
  .catch(() => { document.getElementById("ip").textContent = "Offline"; updateIPHeader(); });

function rotateIP() {
  const btn = document.getElementById("rotateBtn");
  const url = document.getElementById("rotateLink").value.trim();
  if (!url) return alert("Enter URL");

  btn.disabled = true;
  btn.innerHTML = "Starting...";

  // Trigger rotation
  new Image().src = url + (url.includes('?') ? '&' : '?') + 't=' + Date.now();

  // 8-second countdown only
  let s = 8;
  const timer = setInterval(() => {
    s--;
    btn.innerHTML = s > 0 ? `Wait ${s}s...` : "Done!";
    if (s <= 0) clearInterval(timer);
  }, 1000);

  // After countdown ‚Üí just reset button, NO auto refresh
  setTimeout(() => {
    btn.innerHTML = "Go";
    btn.disabled = false;
    showToast("Rotation triggered!");
  }, 8500);
}

function refreshAndOpen() {
  const btn = document.getElementById("refreshBtn"); btn.disabled=true; btn.innerHTML="Loading...";
  if (!scamalyticsWindow || scamalyticsWindow.closed) scamalyticsWindow = window.open('about:blank','_blank');
  fetch('https://api.ipify.org?format=json')
    .then(r=>r.json())
    .then(d=>{
      if(userIP){ previousIP=userIP; document.getElementById("oldIP").textContent=previousIP; }
      userIP=d.ip; document.getElementById("ip").textContent=userIP; updateIPHeader();
      scamalyticsWindow.location.href=`https://scamalytics.com/ip/${userIP}`;
      btn.style.backgroundColor = (previousIP && previousIP!==userIP) ? "#2e7d32" : "#d32f2f";
      btn.innerHTML = (previousIP && previousIP!==userIP) ? "Changed!" : "No Change";
    })
    .catch(()=>{ btn.style.backgroundColor="#b71c1c"; btn.innerHTML="Failed"; })
    .finally(()=>{ btn.disabled=false; });
}

function showToast(m) {
  const t = document.getElementById('toast'); t.textContent=m; t.classList.add('show');
  clearTimeout(t.timeout); t.timeout=setTimeout(()=>t.classList.remove('show'),1800);
}

window.addEventListener('load', () => {
  ['subContent','capContent','ipContent'].forEach(id => document.getElementById(id).classList.remove('open'));
  ['subArrow','capArrow','ipArrow'].forEach(id => document.getElementById(id).classList.remove('open'));
  updateIPHeader();
});


// === PROFILE SYSTEM - FULLY PRIVATE + REMEMBERS LAST PROFILE ===
const PROFILE_URL = "https://script.google.com/macros/s/AKfycby8h_cdtEIHYjpewRUu48hq2u9eC5pYYwlxYBm5BP6yXPu4CZ8ngWwEXhvwwSqN0h3V/exec"; // ‚Üê YOUR WEB APP URL HERE

let profileData = [];
let currentRow = 2;
let currentIndex = parseInt(localStorage.getItem('lastProfileIndex') || '0'); // remembers your place

function loadProfiles() {
  fetch(PROFILE_URL + "?action=read&t=" + Date.now())
    .then(r => r.json())
    .then(d => {
      profileData = d.values || [];
      if (profileData.length === 0) {
        showToast("Sheet is empty");
        clearProfileFields();
      } else {
        // Clamp index in case sheet changed
        if (currentIndex >= profileData.length) currentIndex = profileData.length - 1;
        loadProfile(currentIndex);
        showToast(`Profile ${currentIndex + 1}/${profileData.length} loaded`);
      }
    })
    .catch(() => showToast("Sheet offline"));
}

function clearProfileFields() {
  document.getElementById('profileName').value = '';
  document.getElementById('profilePass').value = '';
  document.getElementById('profileUser').value = '';
  document.getElementById('profileID').value = '';
}

function loadProfile(index) {
  if (profileData.length === 0) return;
  if (index < 0) index = 0;
  if (index >= profileData.length) index = profileData.length - 1;

  const row = profileData[index];
  document.getElementById('profileName').value = row[0] || '';
  document.getElementById('profilePass').value = row[1] || '';
  document.getElementById('profileUser').value = row[2] || '';
  document.getElementById('profileID').value   = row[3] || '';

  currentRow = index + 2;
  currentIndex = index;
  localStorage.setItem('lastProfileIndex', index); // remembers even after refresh/close
}

function prevProfile() { loadProfile(currentIndex - 1); }
function nextProfile() { loadProfile(currentIndex + 1); }

function generatePassword() {
    if (document.getElementById('profilePass').value !== '') {
        return showToast("Password not empty");
    }

    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*_-";
    let randomPart = "";
    const len = Math.floor(Math.random() * 5) + 10; // 10‚Äì14 chars for better security

    for (let i = 0; i < len; i++) {
        randomPart += chars.charAt(Math.floor(Math.random() * chars.length));
    }

    const finalPassword = "reddit" + randomPart;

    document.getElementById('profilePass').value = finalPassword;
    copyText('profilePass');
    showToast(`Generated: ${finalPassword}`);
}

async function pasteUsername() {
  try {
    const text = await navigator.clipboard.readText();
    document.getElementById('profileUser').value = text.trim();
    showToast("Username pasted");
  } catch {
    showToast("Paste failed (allow clipboard)");
  }
}

document.getElementById('comboFab').onclick = () => {
  // === 1. GET NEXT UNUSED SUBREDDIT ===
  if (subs.length === 0) return showToast("No subs left!");

  let sub = '';
  let startIndex = subIndex;
  do {
    sub = subs[subIndex];
    if (!subChecked[sub]) break;
    subIndex = (subIndex + 1) % subs.length;
  } while (subIndex !== startIndex);

  if (subChecked[sub]) {
    subChecked = {}; subIndex = 0; save();
    showToast("All subs used ‚Üí Auto-reset!");
  }

  subChecked[sub] = true;
  subIndex = (subIndex + 1) % subs.length;
  save();

  // === 2. GET NEXT UNUSED CAPTION ===
  const unusedCaps = captions.filter(c => !capUsed[c]);
  if (unusedCaps.length === 0) {
    capUsed = {}; save();
    showToast("Captions reset!");
    return;
  }
  const caption = unusedCaps[Math.floor(Math.random() * unusedCaps.length)];
  capUsed[caption] = true;
  save();

  // === 3. OPEN REDDIT WITH CAPTION IN TITLE ===
  const encodedTitle = encodeURIComponent(caption.trim());
  const redditUrl = `https://www.reddit.com/r/${sub}/submit?title=${encodedTitle}`;
  
  window.open(redditUrl, '_blank');

  // === 4. UPDATE LISTS ===
  render('subList', subs, subChecked);
  render('captionList', captions, capUsed);
  updateStats();

  // === 5. COPY SUBREDDIT TO CLIPBOARD (optional, for manual use) ===
  navigator.clipboard.writeText(sub);
  showToast(`Posted ‚Üí r/${sub}`);
};
  

function saveProfile() {
  const pass = document.getElementById('profilePass').value.trim();
  const user = document.getElementById('profileUser').value.trim();
  if (!pass || !user) return showToast("Fill Password & Username");

  fetch(`${PROFILE_URL}?action=write&row=${currentRow}&pass=${encodeURIComponent(pass)}&user=${encodeURIComponent(user)}&t=${Date.now()}`)
    .then(r => r.json())
    .then(() => {
      showToast("Saved to sheet");
      profileData[currentIndex][1] = pass;
      profileData[currentIndex][2] = user;
    })
    .catch(() => showToast("Save failed"));
}

function copyText(id) {
  const el = document.getElementById(id);
  el.focus();
  el.select();
  navigator.clipboard.writeText(el.value);
  showToast((el.placeholder || el.id) + " copied");
}

document.getElementById('fabCreate').onclick = () => {
  const currentID = document.getElementById('profileID').value.trim();
  if (!currentID) {
    showToast("No ID loaded");
    return;
  }
  
  // Copy ID to clipboard
  navigator.clipboard.writeText(currentID);
  
  // Run your iOS Shortcut
  window.location.href = "shortcuts://run-shortcut?name=CreateRed";
  
  showToast("ID copied ‚Üí CreateRed launched");
};
// Auto-load on start (and remember last profile)
window.addEventListener('load', loadProfiles);
</script>
</body>
</html>
